<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="keywords" content="Hexo Theme Keep">
    <meta name="description" content="白日梦重度患者">
    <meta name="author" content="breewf">
    
    <title>
        
            四大组件_ContentProvider |
        
        breewf
    </title>
    
<link rel="stylesheet" href="/css/style.css">

    <link rel="shortcut icon" href="https://avatars.githubusercontent.com/u/10130323?s=400&u=90608a86412bc1da2ca6aafec22b20e068463ce8&v=4">
    
<link rel="stylesheet" href="/css/font-awesome.min.css">

    <script id="hexo-configurations">
    let KEEP = window.KEEP || {};
    KEEP.hexo_config = {"hostname":"github.com","root":"/","language":"zh-CN"};
    KEEP.theme_config = {"toc":{"enable":true,"number":true,"expand_all":true,"init_open":true},"style":{"primary_color":"#0066CC","avatar":"https://avatars.githubusercontent.com/u/10130323?s=400&u=90608a86412bc1da2ca6aafec22b20e068463ce8&v=4","favicon":"https://avatars.githubusercontent.com/u/10130323?s=400&u=90608a86412bc1da2ca6aafec22b20e068463ce8&v=4","article_img_align":"left","left_side_width":"260px","content_max_width":"920px","hover":{"shadow":false,"scale":false},"first_screen":{"enable":false,"background_img":"/images/bg.svg","description":"Keep writing and Keep loving."},"scroll":{"progress_bar":{"enable":false},"percent":{"enable":true}}},"local_search":{"enable":false,"preload":false},"code_copy":{"enable":true,"style":"default"},"pjax":{"enable":false},"lazyload":{"enable":false},"version":"3.4.3"};
    KEEP.language_ago = {"second":"%s 秒前","minute":"%s 分钟前","hour":"%s 小时前","day":"%s 天前","week":"%s 周前","month":"%s 月前","year":"%s 年前"};
  </script>
<meta name="generator" content="Hexo 5.4.0"></head>


<body>
<div class="progress-bar-container">
    

    
</div>


<main class="page-container">

    

    <div class="page-main-content">

        <div class="page-main-content-top">
            <header class="header-wrapper">

    <div class="header-content">
        <div class="left">
            
            <a class="logo-title" href="/">
                breewf
            </a>
        </div>

        <div class="right">
            <div class="pc">
                <ul class="menu-list">
                    
                        <li class="menu-item">
                            <a class=""
                               href="/"
                            >
                                首页
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/archives"
                            >
                                归档
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/categories"
                            >
                                分类
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/tags"
                            >
                                标签
                            </a>
                        </li>
                    
                        <li class="menu-item">
                            <a class=""
                               href="/about"
                            >
                                关于
                            </a>
                        </li>
                    
                    
                </ul>
            </div>
            <div class="mobile">
                
                <div class="icon-item menu-bar">
                    <div class="menu-bar-middle"></div>
                </div>
            </div>
        </div>
    </div>

    <div class="header-drawer">
        <ul class="drawer-menu-list">
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/">首页</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/archives">归档</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/categories">分类</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/tags">标签</a>
                </li>
            
                <li class="drawer-menu-item flex-center">
                    <a class=""
                       href="/about">关于</a>
                </li>
            
        </ul>
    </div>

    <div class="window-mask"></div>

</header>


        </div>

        <div class="page-main-content-middle">

            <div class="main-content">

                
                    <div class="fade-in-down-animation">
    <div class="article-content-container">

        <div class="article-title">
            <span class="title-hover-animation">四大组件_ContentProvider</span>
        </div>

        
            <div class="article-header">
                <div class="avatar">
                    <img src="https://avatars.githubusercontent.com/u/10130323?s=400&u=90608a86412bc1da2ca6aafec22b20e068463ce8&v=4">
                </div>
                <div class="info">
                    <div class="author">
                        <span class="name">breewf</span>
                        
                    </div>
                    <div class="meta-info">
                        <div class="article-meta-info">
    <span class="article-date article-meta-item">
        <i class="fas fa-edit"></i>&nbsp;2021-08-06 15:24:00
    </span>
    
        <span class="article-categories article-meta-item">
            <i class="fas fa-folder"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/categories/%E5%AE%89%E5%8D%93/">安卓</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    
    
        <span class="article-tags article-meta-item">
            <i class="fas fa-tags"></i>&nbsp;
            <ul>
                
                    <li>
                        <a href="/tags/%E7%9F%A5%E8%AF%86%E7%82%B9/">知识点</a>&nbsp;
                    </li>
                
            </ul>
        </span>
    

    
    
    
    
</div>

                    </div>
                </div>
            </div>
        

        <div class="article-content markdown-body">
            <h2 id="什么是ContentProvider"><a href="#什么是ContentProvider" class="headerlink" title="什么是ContentProvider"></a>什么是ContentProvider</h2><p>内容提供者（ContentProvider），ContentProvider作为Android四大组件之一，为存储和获取数据提供统一的接口，可以在不同的应用程序之间共享数据。</p>
<p>ContentProvider 主要的作用就是将程序的内部数据和外部进行共享，为数据提供外部访问接口，被访问的数据主要以数据库的形式存在，而且还可以选择共享哪一部分的数据。这样一来，对于程序当中的隐私数据可以不共享，从而更加安全。 ContentProvider 是 Android 中一种<strong>跨程序共享数据的重要组件</strong>。</p>
<p>与文件存储、SharedPreferences 存储、SQLite 数据库存储这几种数据存储方法不同的是，后几者保存下的数据只能被该应用程序使用，而ContentProvider可以让不同应用程序之间进行数据共享，它还可以选择只对哪一部分数据进行共享，从而保证程序中的隐私数据不会有泄漏风险。</p>
<p>ContentProvider为应用间的数据交互提供了一个安全的环境：允许把自己的应用数据根据需求开放给其他的应用，而不用担心因为直接开放数据库权限而带来的安全问题。而其他对外共享数据的方式，数据访问方式会因数据存储的方式而不同而发生变化，底层存储方式变更会影响上层，使访问数据变得更加复杂。<strong>而采用ContentProvider方式，其解耦了底层数据的存储方式，使得无论底层数据存储采用何种方式，外界对数据的访问方式都是统一的，这使得访问简单且高效</strong>。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL3VwbG9hZC1pbWFnZXMuamlhbnNodS5pby91cGxvYWRfaW1hZ2VzLzk0NDM2NS0zYzQzMzljNWYxZDRhMGZkLnBuZz9pbWFnZU1vZ3IyL2F1dG8tb3JpZW50L3N0cmlwJTdDaW1hZ2VWaWV3Mi8yL3cvMTI0MA"></p>
<p>ContentProvider 有两种形式：</p>
<ul>
<li>可以使用现有的内容提供者来读取和操作相应程序中的数据。</li>
<li>也可以创建自己的内容提供者给这个程序的数据提供外部访问接口。</li>
</ul>
<h2 id="ContentProvider如何共享数据"><a href="#ContentProvider如何共享数据" class="headerlink" title="ContentProvider如何共享数据"></a>ContentProvider如何共享数据</h2><p>ContentProvider通过<strong>uri</strong>来标识其它应用要访问的数据，通过<strong>ContentResolver</strong>的增、删、改、查方法实现对共享数据的操作。还可以通过注册ContentObserver来监听数据是否发生了变化来对应的刷新页面。</p>
<p>注册监听器监听Provider数据改变：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">getContentResolver().registerContentObserver(uri, true, new ContentObserver(new Handler()) &#123;</span><br><span class="line">    public void onChange(boolean selfChange) &#123;                              </span><br><span class="line">        // 收到数据改变，在此做出相应处理</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>要使监听生效，自定义Provider中，每个操作成功后都需要调用如下方法进行通知：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getContext().getContentResolver().notifyChange(uri, null);</span><br></pre></td></tr></table></figure>

<h2 id="Content-URI"><a href="#Content-URI" class="headerlink" title="Content URI"></a>Content URI</h2><h3 id="URI"><a href="#URI" class="headerlink" title="URI"></a>URI</h3><ul>
<li>定义：Uniform Resource Identifier，即统一资源标识符</li>
<li>作用：唯一标识 ContentProvider &amp; 其中的数据</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">格式：content://authorities/path/id</span><br></pre></td></tr></table></figure>

<ul>
<li>content://：协议名，表示这是一个Content URI，用于访问 ContentProvider。</li>
<li>authorities：是提供程序的授权，相当于域名，指定某个 ContentProvider。</li>
<li>path：表示路径，通常用表名表示。</li>
<li>id：具体数字（long），用于指定访问具体哪一行数据。</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/944365-96019a2054eb27cf.png"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// 设置URI</span><br><span class="line">Uri uri = Uri.parse(&quot;content://com.carson.provider/User/1&quot;) </span><br><span class="line">// 上述URI指向的资源是：名为 `com.carson.provider`的`ContentProvider` 中表名 为`User` 中的 `id`为1的数据</span><br><span class="line"></span><br><span class="line">// 特别注意：URI模式存在匹配通配符* &amp; ＃</span><br><span class="line"></span><br><span class="line">// *：匹配任意长度的任何有效字符的字符串</span><br><span class="line">// 以下的URI 表示 匹配provider的任何内容</span><br><span class="line">content://com.example.app.provider/* </span><br><span class="line">// ＃：匹配任意长度的数字字符的字符串</span><br><span class="line">// 以下的URI 表示 匹配provider中的table表的所有行</span><br><span class="line">content://com.example.app.provider/table/# </span><br></pre></td></tr></table></figure>

<h3 id="UriMatcher"><a href="#UriMatcher" class="headerlink" title="UriMatcher"></a>UriMatcher</h3><p>这是一个内置的URI工具，他一共只提供了两个开放方法addURI()、match()，这是一个用于帮助匹配ContentProvider中URI的方法，针对的是除去id前半段匹配。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">// 用法</span><br><span class="line">UriMatcher uriMatcher = new UriMatcher(UriMatcher.NO_MATCH);</span><br><span class="line">String authority = &quot;com.clericyi.file&quot;;</span><br><span class="line">String path = &quot;message&quot;;</span><br><span class="line">int URI_CODE = 1;</span><br><span class="line">// 将URI和URI_CODE关联</span><br><span class="line">uriMatcher.addURI(authority, path, URI_CODE);</span><br><span class="line">// 用于获取对应的URI_CODE</span><br><span class="line">uriMatcher.match(Uri.parse(&quot;content://com.clericyi.file/message&quot;))</span><br></pre></td></tr></table></figure>

<p>UriMatcher还可以使用匹配通配符来匹配任意不确定的值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">matcher = new UriMatcher(UriMatcher.NO_MATCH);</span><br><span class="line">// Authority 、路径、匹配码</span><br><span class="line">matcher.addURI(&quot;cn.tim.myprovider&quot;, &quot;hello&quot;, 1001);</span><br><span class="line"></span><br><span class="line">// 匹配 cn.tim.myprovider/hello/任意数字</span><br><span class="line">matcher.addURI(&quot;cn.tim.myprovider&quot;, &quot;hello/#&quot;, 1002);</span><br><span class="line"></span><br><span class="line">// 匹配 cn.tim.myprovider/world/任意字符串</span><br><span class="line">matcher.addURI(&quot;cn.tim.myprovider&quot;, &quot;world/*&quot;, 1003);</span><br></pre></td></tr></table></figure>

<h3 id="ContentUris"><a href="#ContentUris" class="headerlink" title="ContentUris"></a>ContentUris</h3><p>同样是一个内置的工具类，提供的方法有parseId()、appendId()、withAppendedId()、removeId()，针对的就是id</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Uri uri = Uri.parse(&quot;content://com.clericyi.file/messag&quot;);</span><br><span class="line">// 连接id</span><br><span class="line">uri = ContentUris.withAppendedId(uri, CODE);</span><br><span class="line">// 去除id</span><br><span class="line">uri = ContentUris.removeId(uri);</span><br><span class="line">// 获取id</span><br><span class="line">long num = ContentUris.parseId(uri);</span><br></pre></td></tr></table></figure>

<h3 id="ContentObserver"><a href="#ContentObserver" class="headerlink" title="ContentObserver"></a>ContentObserver</h3><ul>
<li>定义：内容观察者</li>
<li>作用：观察 Uri 引起 ContentProvider 中的数据变化 &amp; 通知外界</li>
</ul>
<blockquote>
<p>当ContentProvider 中的数据发生变化（增、删 &amp; 改）时，就会触发该 ContentObserver类</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">// 步骤1：注册内容观察者ContentObserver</span><br><span class="line">    getContentResolver().registerContentObserver（uri）；</span><br><span class="line">    // 通过ContentResolver类进行注册，并指定需要观察的URI</span><br><span class="line"></span><br><span class="line">// 步骤2：当该URI的ContentProvider数据发生变化时，通知外界（即访问该ContentProvider数据的访问者）</span><br><span class="line">    public class UserContentProvider extends ContentProvider &#123; </span><br><span class="line">      public Uri insert(Uri uri, ContentValues values) &#123; </span><br><span class="line">      db.insert(&quot;user&quot;, &quot;userid&quot;, values); </span><br><span class="line">      // 通知访问者</span><br><span class="line">      getContext().getContentResolver().notifyChange(uri, null); </span><br><span class="line">   &#125; </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 步骤3：解除观察者</span><br><span class="line"> getContentResolver().unregisterContentObserver（uri）；</span><br><span class="line">    // 同样需要通过ContentResolver类进行解除</span><br></pre></td></tr></table></figure>

<h3 id="Uri自带的解析方法"><a href="#Uri自带的解析方法" class="headerlink" title="Uri自带的解析方法"></a>Uri自带的解析方法</h3><p>我们把参数写在了Uri里面，这样在ContentProvider中又是如何解析的呢？</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Uri insertUri = Uri.parse(&quot;content://cn.tim.myprovider/whatever?name=Tim&amp;age=22&amp;gender=男&quot;);</span><br><span class="line">Uri uri = contentResolver.insert(insertUri, new ContentValues());</span><br><span class="line">long newId = ContentUris.parseId(uri);</span><br><span class="line">Toast.makeText(this, &quot;添加成功: Id&quot; + newId, Toast.LENGTH_SHORT).show();</span><br></pre></td></tr></table></figure>

<p>MyContentProvider.java的关键代码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public Uri insert(Uri uri, ContentValues values) &#123;</span><br><span class="line">        long id = 0;</span><br><span class="line">    	// 为了保持原来的方式不做变更，所以这里需要判断一下</span><br><span class="line">        if(values.size() &gt; 0)&#123;</span><br><span class="line">            id = sqLiteDatabase.insert(&quot;stu_info&quot;, null, values);</span><br><span class="line">        &#125;else &#123;</span><br><span class="line">            String authority = uri.getAuthority();</span><br><span class="line">            String path = uri.getPath();</span><br><span class="line">            String query = uri.getQuery();</span><br><span class="line">            String name = uri.getQueryParameter(&quot;name&quot;);</span><br><span class="line">            String age = uri.getQueryParameter(&quot;age&quot;);</span><br><span class="line">            String gender = uri.getQueryParameter(&quot;gender&quot;);</span><br><span class="line">            Log.i(TAG, &quot;insert:-&gt;主机名:&quot; + authority</span><br><span class="line">                    + &quot;，路径:&quot; + path + &quot;，查询数据:&quot; + query + &quot;，姓名:&quot; + name</span><br><span class="line">            + &quot;，age:&quot; + age + &quot;，gender:&quot; + gender);</span><br><span class="line">            values.put(&quot;name&quot;, name);</span><br><span class="line">            values.put(&quot;age&quot;, age);</span><br><span class="line">            values.put(&quot;gender&quot;, gender);</span><br><span class="line">            id = sqLiteDatabase.insert(&quot;stu_info&quot;, null, values);</span><br><span class="line">        &#125;</span><br><span class="line">        return ContentUris.withAppendedId(uri, id);    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>URI和Uri是什么关系呢，Uri是Android的API，扩展了JavaSE中URI的一些功能来特定的适用于Android开发，所以大家在开发时，只使用Android 提供的Uri即可。</p>
<p>统一资源标志符URI就是在某一规则下把一个资源独一无二地标识出来，URL就是某主机上的某路径上的文件来唯一确定一个资源，也就是定位的方式来实现的URI，<strong>即URL是URI的一种实现</strong>。</p>
</blockquote>
<h2 id="ContentResolver类"><a href="#ContentResolver类" class="headerlink" title="ContentResolver类"></a>ContentResolver类</h2><p>ContentProvider类并不会直接与外部进程交互，而是通过 ContentResolver 类。</p>
<p>作用：统一管理不同 ContentProvider间的操作。</p>
<ul>
<li>即通过 URI 即可操作 不同的 ContentProvider 中的数据</li>
<li>外部进程通过 ContentResolver 类从而与ContentProvider类进行交互</li>
</ul>
<blockquote>
<p>为什么要使用通过ContentResolver类与ContentProvider类进行交互，而不直接访问ContentProvider类？</p>
<p>一般来说，一款应用要使用多个ContentProvider，若需要了解每个ContentProvider的不同实现从而再完成数据交互，操作成本高 &amp; 难度大，所以在ContentProvider类上加了一个 ContentResolver 类对所有的ContentProvider进行统一管理。</p>
</blockquote>
<p>ContentResolver 类提供了与ContentProvider类相同名字 &amp; 作用的4个方法</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 外部向 ContentProvider 中添加数据</span><br><span class="line">public Uri insert(Uri uri, ContentValues values)　 </span><br><span class="line"></span><br><span class="line">// 外部删除 ContentProvider 中的数据</span><br><span class="line">public int delete(Uri uri, String selection, String[] selectionArgs)</span><br><span class="line"></span><br><span class="line">// 外部更新 ContentProvider 中的数据</span><br><span class="line">public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs)　 </span><br><span class="line"></span><br><span class="line">// 外部获取 ContentProvider 中的数据</span><br><span class="line">public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder)</span><br></pre></td></tr></table></figure>

<p>实例说明：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">// 使用ContentResolver前，需要先获取ContentResolver</span><br><span class="line">// 可通过在所有继承Context的类中 通过调用getContentResolver()来获得ContentResolver</span><br><span class="line">ContentResolver resolver = getContentResolver(); </span><br><span class="line"></span><br><span class="line">// 设置ContentProvider的URI</span><br><span class="line">Uri uri = Uri.parse(&quot;content://cn.scu.myprovider/user&quot;); </span><br><span class="line"> </span><br><span class="line">// 根据URI 操作 ContentProvider中的数据</span><br><span class="line">// 此处是获取ContentProvider中 user 表的所有记录 </span><br><span class="line">Cursor cursor = resolver.query(uri, null, null, null, &quot;userid desc&quot;); </span><br></pre></td></tr></table></figure>


<h2 id="ContentProvider分类"><a href="#ContentProvider分类" class="headerlink" title="ContentProvider分类"></a>ContentProvider分类</h2><h3 id="系统的-ContentProvider"><a href="#系统的-ContentProvider" class="headerlink" title="系统的 ContentProvider"></a>系统的 ContentProvider</h3><p>系统的 ContentProvider 有很多，如通话记录、短信、通讯录等等，都需要和第三方的 App 进行共享数据。使用内容提供者的步骤如下:</p>
<ul>
<li>获取 ContentResolver 实例</li>
<li>确定 Uri 的内容，并解析为具体的 Uri 实例</li>
<li>通过 ContentResolver 实例来调用相应的方法，传递相应的参数，但是第一个参数总是 Uri，它制定了我们要操作的数据的具体地址</li>
</ul>
<p>例子：读取联系人信息</p>
<ul>
<li>清单文件中添加读取权限</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;uses-permission android:name=&quot;android.permission.READ_CONTACTS&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>针对 6.0+ 系统动态权限申请</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">//判断是否有读取联系人权限</span><br><span class="line">if (ContextCompat.checkSelfPermission(this, Manifest.permission.READ_CONTACTS) != PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">    ActivityCompat.requestPermissions(this, new String[]&#123;Manifest.permission.READ_CONTACTS&#125;, 1);</span><br><span class="line">&#125; else &#123;</span><br><span class="line">    readContacts();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>重写 onRequestPermissionsResult( ) 方法获取权限申请返回</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void onRequestPermissionsResult(int requestCode, @NonNull String[] permissions, @NonNull int[] grantResults) &#123;</span><br><span class="line">    super.onRequestPermissionsResult(requestCode, permissions, grantResults);</span><br><span class="line">    switch (requestCode) &#123;</span><br><span class="line">        case 1:</span><br><span class="line">            if (grantResults.length &gt; 0 &amp;&amp; grantResults[0] == PackageManager.PERMISSION_GRANTED) &#123;</span><br><span class="line">                readContacts();</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                Toast.makeText(this, &quot;获取权限失败！&quot;, Toast.LENGTH_SHORT);</span><br><span class="line">            &#125;</span><br><span class="line">            break;</span><br><span class="line">        default:</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>获取手机通讯录</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">private void readContacts() &#123;</span><br><span class="line">    List contactsList=null;</span><br><span class="line">    Cursor cursor=null;</span><br><span class="line">    try &#123;</span><br><span class="line">        contactsList=new ArrayList();</span><br><span class="line">        //查询联系人数据,使用了getContentResolver().query方法来查询系统的联系人的数据</span><br><span class="line">        //CONTENT_URI就是一个封装好的Uri，是已经解析过得常量</span><br><span class="line">        cursor=getContentResolver().query(ContactsContract.CommonDataKinds.Phone.CONTENT_URI,null,null,null,null);</span><br><span class="line">        //对cursor进行遍历，取出姓名和电话号码</span><br><span class="line">        if (cursor!=null)&#123;</span><br><span class="line">            while (cursor.moveToNext())&#123;</span><br><span class="line">                //获取联系人姓名</span><br><span class="line">                String displayName=cursor.getString(cursor.getColumnIndex(</span><br><span class="line">                    ContactsContract.CommonDataKinds.Phone.DISPLAY_NAME</span><br><span class="line">                    ));</span><br><span class="line">                //获取联系人手机号</span><br><span class="line">                String number=cursor.getString(cursor.getColumnIndex(</span><br><span class="line">                    ContactsContract.CommonDataKinds.Phone.NUMBER</span><br><span class="line">                    ));</span><br><span class="line">                //把取出的两类数据进行拼接，中间加换行符，然后添加到列表中</span><br><span class="line">                contactsList.add(displayName+&quot;\n&quot;+number);</span><br><span class="line">                LogUtils.i(&quot;姓名：&quot;+displayName+&quot;\n&quot;+&quot;电话：&quot;+number);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;catch (Exception e)&#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;finally &#123;</span><br><span class="line">            //关掉cursor</span><br><span class="line">            if (cursor!=null)&#123;</span><br><span class="line">                cursor.close();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="自定义-ContentProvider"><a href="#自定义-ContentProvider" class="headerlink" title="自定义 ContentProvider"></a>自定义 ContentProvider</h3><p>想自定义自己的ContentProvider，需要继承ContentProvider类，重写这个类中的抽象方法，并<strong>在清单文件中注册</strong>，最后才能够正常使用。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;provider</span><br><span class="line">            android:name=&quot;.MyContentProvider&quot;</span><br><span class="line">            android:authorities=&quot;com.hy.MyContentProvider&quot;</span><br><span class="line">            android:enabled=&quot;true&quot;</span><br><span class="line">            android:exported=&quot;true&quot; /&gt;</span><br></pre></td></tr></table></figure>

<ul>
<li>name：ContentProvider 的全称类名</li>
<li>authorities：唯一标识了一个 ContentProvider，外部应用通过该属性值来访问我们的 ContentProvider。因此该属性值必须是唯一的，建议在命名时以包名为前缀。</li>
<li>exported：表明是否允许其他应用调用 ContentProvider，true 表示支持，false 表示不支持。默认值根据开发者的属性设置而会有所不同，如果包含 Intent-Filter 则默认值为 true，否则为 false。</li>
</ul>
<p>自定义类继承 ContentProvider，重写六个方法：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">public class MyContentProvider extends ContentProvider &#123;</span><br><span class="line">    /**</span><br><span class="line">     * 初始化内容提供器的时候调用。通常会在这里完成对数据库的创建和升级等操作，</span><br><span class="line">     * 返回 true 表示内容提供器初始化成功，返回 false 则表示失败。注意，只有</span><br><span class="line">     * 当存在 ContentResolver 尝试访问我们程序中的数据时，内容提供器才会被初始化。</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public boolean onCreate() &#123;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 从内容提供器中查询数据。使用 uri 参数来确定查询哪张表，projection 参数用</span><br><span class="line">     * 于确 定查询哪些列，selection 和 selectionArgs 参数用于约束查询哪些行，</span><br><span class="line">     * sortOrder 参数用于 对结果进行排序，查询的结果存放在 Cursor 对象中返回。</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 向内容提供器中添加一条数据。使用 uri 参数来确定要添加到的表，待添加的数据</span><br><span class="line">     * 保存在 values 参数中。添加完成后，返回一个用于表示这条新记录的 URI。</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public Uri insert(Uri uri, ContentValues values) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 更新内容提供器中已有的数据。使用 uri 参数来确定更新哪一张表中的数据，新数</span><br><span class="line">     * 据保存在 values 参数中，selection 和 selectionArgs 参数用于约束更新哪些行，</span><br><span class="line">     * 受影响的行数将作为返回值返回。</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public int update(Uri uri, ContentValues values, String selection, String[] selectionArgs) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 从内容提供器中删除数据。使用 uri 参数来确定删除哪一张表中的数据，selection</span><br><span class="line">     * 和 selectionArgs 参数用于约束删除哪些行，被删除的行数将作为返回值返回。</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public int delete(Uri uri, String selection, String[] selectionArgs) &#123;</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * 根据传入的内容 URI 来返回相应的 MIME 类型。 可以看到，几乎每一个方法都会</span><br><span class="line">     * 带有 Uri 这个参数，这个参数也正是调用 ContentResolver的增删改查方法时传</span><br><span class="line">     * 递过来的。而现在，我们需要对传入的 Uri 参数进行解析，从中分析出调用方</span><br><span class="line">     * 期望访问的表和数据。</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public String getType(Uri uri) &#123;</span><br><span class="line">        return null;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>使用 UriMatcher</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public class MyContentProvider extends ContentProvider &#123;</span><br><span class="line">    public static final int TABLE1_DIR = 0;</span><br><span class="line"></span><br><span class="line">    public static final int TABLE1_ITEM = 1;</span><br><span class="line"></span><br><span class="line">    public static final int TABLE2_DIR = 2;</span><br><span class="line"></span><br><span class="line">    public static final int TABLE2_ITEM = 3;</span><br><span class="line"></span><br><span class="line">    private static UriMatcher uriMatcher; </span><br><span class="line">    </span><br><span class="line">    static &#123;</span><br><span class="line"></span><br><span class="line">        uriMatcher = new UriMatcher(UriMatcher.NO_MATCH);</span><br><span class="line"></span><br><span class="line">        uriMatcher.addURI(&quot;com.keven.jianshu.provider&quot;, &quot;table1&quot;, TABLE1_DIR);</span><br><span class="line"></span><br><span class="line">        uriMatcher.addURI(&quot;com.keven.jianshu.provider &quot;, &quot;table1/#&quot;, TABLE1_ITEM);</span><br><span class="line"></span><br><span class="line">        uriMatcher.addURI(&quot;com.keven.jianshu.provider &quot;, &quot;table2&quot;, TABLE2_ITEM);</span><br><span class="line"></span><br><span class="line">        uriMatcher.addURI(&quot;com.keven.jianshu.provider &quot;, &quot;table2/#&quot;, TABLE2_ITEM);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    ......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>以 query( ) 方法为例示范(insert()、update()、delete() 实现类似)</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public Cursor query(Uri uri, String[] projection, String selection, String[] selectionArgs, String sortOrder) &#123;</span><br><span class="line">switch (uriMatcher.match(uri)) &#123;</span><br><span class="line">    case TABLE1_DIR:</span><br><span class="line">    // 查询table1表中的所有数据</span><br><span class="line">        break;</span><br><span class="line"></span><br><span class="line">    case TABLE1_ITEM:</span><br><span class="line">    // 查询table1表中的单条数据</span><br><span class="line">        break;</span><br><span class="line"></span><br><span class="line">    case TABLE2_DIR:</span><br><span class="line">    // 查询table2表中的所有数据</span><br><span class="line">        break;</span><br><span class="line"></span><br><span class="line">    case TABLE2_ITEM:</span><br><span class="line">    // 查询table2表中的单条数据</span><br><span class="line">        break;</span><br><span class="line"></span><br><span class="line">    default:</span><br><span class="line">        break;</span><br><span class="line">    &#125;</span><br><span class="line">    ……</span><br><span class="line">&#125;</span><br><span class="line">……</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>除此之外，还有一个方法你会比较陌生，即 getType() 方法。它是所有的内容提供器都必 须提供的一个方法，用于获取 Uri 对象所对应的 MIME 类型。一个内容 URI 所对应的 MIME 字符串主要由三部分组分，Android 对这三个部分做了如下格式规定：</p>
<ul>
<li>必须以 vnd 开头</li>
<li>如果内容 URI 以路径结尾，则后接 android.cursor.dir/，如果内容 URI 以 id 结尾， 则后接 android.cursor.item/</li>
<li>最后接上 vnd.</li>
</ul>
<p>所以，对于 content://com.example.app.provider/table1 这个内容 URI，它所对应的 MIME 类型就可以写成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vnd.android.cursor.dir/vnd.com.example.app.provider.table1</span><br></pre></td></tr></table></figure>

<p>对于 content://com.example.app.provider/table1/1 这个内容 URI，它所对应的 MIME 类型 就可以写成：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vnd.android.cursor.item/vnd.com.example.app.provider.table1</span><br></pre></td></tr></table></figure>

<p>则我们的自定义 Provider 可以完善为</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"></span><br><span class="line">public String getType(Uri uri) &#123; </span><br><span class="line"></span><br><span class="line">switch (uriMatcher.match(uri)) &#123; </span><br><span class="line"></span><br><span class="line">    case TABLE1_DIR:</span><br><span class="line">        return &quot;vnd.android.cursor.dir/vnd.com.example.app.provider.table1&quot;;</span><br><span class="line"></span><br><span class="line">    case TABLE1_ITEM:</span><br><span class="line">        return &quot;vnd.android.cursor.item/vnd.com.example.app.provider.table1&quot;;</span><br><span class="line"></span><br><span class="line">    case TABLE2_DIR:</span><br><span class="line">        return &quot;vnd.android.cursor.dir/vnd.com.example.app.provider.table2&quot;;</span><br><span class="line"></span><br><span class="line">    case TABLE2_ITEM:</span><br><span class="line">        return &quot;vnd.android.cursor.item/vnd.com.example.app.provider.table2&quot;;</span><br><span class="line"></span><br><span class="line">    default:</span><br><span class="line">        break;</span><br><span class="line">&#125;</span><br><span class="line">return null;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><p><a class="link"   target="_blank" rel="noopener" href="https://juejin.cn/post/6844903814886064135#heading-4" >Android 四大组件之 ContentProvider<i class="fas fa-external-link-alt"></i></a></p>

        </div>

        

        
            <div class="article-nav">
                
                    <div class="article-prev">
                        <a class="prev"
                           rel="prev"
                           href="/2021/08/06/%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6_BroadcastReceiver/"
                        >
                            <span class="left arrow-icon flex-center">
                              <i class="fas fa-chevron-left"></i>
                            </span>
                            <span class="title flex-center">
                                <span class="post-nav-title-item">四大组件_BroadcastReceiver</span>
                                <span class="post-nav-item">上一篇</span>
                            </span>
                        </a>
                    </div>
                
                
                    <div class="article-next">
                        <a class="next"
                           rel="next"
                           href="/2021/08/06/%E5%9B%9B%E5%A4%A7%E7%BB%84%E4%BB%B6_Service/"
                        >
                            <span class="title flex-center">
                                <span class="post-nav-title-item">四大组件_Service</span>
                                <span class="post-nav-item">下一篇</span>
                            </span>
                            <span class="right arrow-icon flex-center">
                              <i class="fas fa-chevron-right"></i>
                            </span>
                        </a>
                    </div>
                
            </div>
        

        
    </div>
</div>


                
            </div>

        </div>

        <div class="page-main-content-bottom">
            <footer class="footer">
    <div class="info-container">
        <div class="copyright-info info-item">
            &copy;
            
              <span>2020</span>&nbsp;-&nbsp;
            
            2021&nbsp;<i class="fas fa-heart icon-animate"></i>&nbsp;<a href="/">breewf</a>
        </div>
        
        <div class="theme-info info-item">
            由 <a target="_blank" href="https://hexo.io">Hexo</a> 驱动&nbsp;|&nbsp;主题&nbsp;<a class="theme-version" target="_blank" href="https://github.com/XPoet/hexo-theme-keep">Keep v3.4.3</a>
        </div>
        
    </div>
</footer>

        </div>
    </div>

    
        <div class="post-tools">
            <div class="post-tools-container">
    <ul class="tools-list">
        <!-- TOC aside toggle -->
        
            <li class="tools-item page-aside-toggle">
                <i class="fas fa-outdent"></i>
            </li>
        

        <!-- go comment -->
        
    </ul>
</div>

        </div>
    

    <div class="right-bottom-side-tools">
        <div class="side-tools-container">
    <ul class="side-tools-list">
        <li class="tools-item tool-font-adjust-plus flex-center">
            <i class="fas fa-search-plus"></i>
        </li>

        <li class="tools-item tool-font-adjust-minus flex-center">
            <i class="fas fa-search-minus"></i>
        </li>

        <li class="tools-item tool-expand-width flex-center">
            <i class="fas fa-arrows-alt-h"></i>
        </li>

        <li class="tools-item tool-dark-light-toggle flex-center">
            <i class="fas fa-moon"></i>
        </li>

        <!-- rss -->
        

        

        <li class="tools-item tool-scroll-to-bottom flex-center">
            <i class="fas fa-arrow-down"></i>
        </li>
    </ul>

    <ul class="exposed-tools-list">
        <li class="tools-item tool-toggle-show flex-center">
            <i class="fas fa-cog fa-spin"></i>
        </li>
        
            <li class="tools-item tool-scroll-to-top flex-center">
                <i class="arrow-up fas fa-arrow-up"></i>
                <span class="percent"></span>
            </li>
        
    </ul>
</div>

    </div>

    
        <aside class="page-aside">
            <div class="post-toc-wrap">
    <div class="post-toc">
        <ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BB%80%E4%B9%88%E6%98%AFContentProvider"><span class="nav-number">1.</span> <span class="nav-text">什么是ContentProvider</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ContentProvider%E5%A6%82%E4%BD%95%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE"><span class="nav-number">2.</span> <span class="nav-text">ContentProvider如何共享数据</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Content-URI"><span class="nav-number">3.</span> <span class="nav-text">Content URI</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#URI"><span class="nav-number">3.1.</span> <span class="nav-text">URI</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#UriMatcher"><span class="nav-number">3.2.</span> <span class="nav-text">UriMatcher</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ContentUris"><span class="nav-number">3.3.</span> <span class="nav-text">ContentUris</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ContentObserver"><span class="nav-number">3.4.</span> <span class="nav-text">ContentObserver</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Uri%E8%87%AA%E5%B8%A6%E7%9A%84%E8%A7%A3%E6%9E%90%E6%96%B9%E6%B3%95"><span class="nav-number">3.5.</span> <span class="nav-text">Uri自带的解析方法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ContentResolver%E7%B1%BB"><span class="nav-number">4.</span> <span class="nav-text">ContentResolver类</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ContentProvider%E5%88%86%E7%B1%BB"><span class="nav-number">5.</span> <span class="nav-text">ContentProvider分类</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%B3%BB%E7%BB%9F%E7%9A%84-ContentProvider"><span class="nav-number">5.1.</span> <span class="nav-text">系统的 ContentProvider</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89-ContentProvider"><span class="nav-number">5.2.</span> <span class="nav-text">自定义 ContentProvider</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%B6%E5%AE%83"><span class="nav-number">6.</span> <span class="nav-text">其它</span></a></li></ol>
    </div>
</div>
        </aside>
    

    <div class="image-viewer-container">
    <img src="">
</div>


    

</main>




<script src="/js/utils.js"></script>

<script src="/js/main.js"></script>

<script src="/js/header-shrink.js"></script>

<script src="/js/back2top.js"></script>

<script src="/js/dark-light-toggle.js"></script>





    
<script src="/js/code-copy.js"></script>





<div class="post-scripts">
    
        
<script src="/js/left-side-toggle.js"></script>

<script src="/js/libs/anime.min.js"></script>

<script src="/js/toc.js"></script>

    
</div>



</body>
</html>
